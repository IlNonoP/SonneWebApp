app-id: com.ilnonop.sonnewebapp
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
command: /app/bin/run.sh
finish-args:
  - --filesystem=home:rw
  - --socket=x11
  - --socket=wayland
  - --share=network
  - --talk-name=org.freedesktop.FileManager1
modules:
  - name: SonneWebApp
    buildsystem: simple
    build-commands:      
      - install -D flatpak/app/main.py ${FLATPAK_DEST}/main.py
      - install -D flatpak/app/icon.png ${FLATPAK_DEST}/share/icons/hicolor/256x256/apps/com.ilnonop.sonnewebapp.png
      - install -D flatpak/SonneWebApp.desktop ${FLATPAK_DEST}/share/applications/com.ilnonop.sonnewebapp.desktop
      - install -D flatpak/app/run.sh ${FLATPAK_DEST}/bin/run.sh
      - install -D flatpak/app/icon.png ${FLATPAK_DEST}/icon.png
    sources:
      - type: git
        url: https://github.com/IlNonoP/SonneWebApp.git
        branch: main

  - name: tkinter
    buildsystem: simple
    build-commands:
      - pip3 install --prefix=${FLATPAK_DEST} .
    sources:
      - type: git
        url: https://github.com/iwalton3/tkinter-standalone
        commit: d9cb97c5bd4f814c73678366e0e48220776b6ad3
    modules:
      - name: tcl8.6
        sources:
          - type: archive
            url: https://sourceforge.net/projects/tcl/files/Tcl/8.6.12/tcl8.6.12-src.tar.gz
            sha256: 26c995dd0f167e48b11961d891ee555f680c175f7173ff8cb829f4ebcde4c1a6
        subdir: unix
        build-commands:
          - ./configure --prefix=${FLATPAK_DEST}
          - make
          - make install
        post-install:
          - chmod +w ${FLATPAK_DEST}/lib/libtcl8.6.so

      - name: tk8.6
        sources:
          - type: archive
            url: https://sourceforge.net/projects/tcl/files/Tcl/8.6.12/tk8.6.12-src.tar.gz
            sha256: 12395c1f3fcb6bed2938689f797ea3cdf41ed5cb6c4766eec8ac949560310630
        subdir: unix
        build-commands:
          - ./configure --prefix=${FLATPAK_DEST}
          - make
          - make install
        post-install:
          - chmod +w ${FLATPAK_DEST}/lib/libtk8.6.so
